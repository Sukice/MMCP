mini_github:
  name: "GitHub 工具箱"
  desc: "提供 GitHub 仓库管理、Issue 追踪、PR 处理及代码搜索能力"
  dir_path: plugin_collection/mini_github/

  functions:
    search_repositories:
      type: function
      function:
        name: "mini_github__search_repositories"
        description: "搜索 GitHub 仓库"
        parameters:
          type: "object"
          properties:
            query: {type: "string", description: "搜索关键词"}
          required: ["query"]

    read_file:
      type: function
      function:
        name: "mini_github__read_file"
        description: "读取 GitHub 仓库中的文件内容"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名 (e.g. user/repo)"}
            file_path: {type: "string", description: "文件路径"}
            branch: {type: "string", description: "分支名 (默认 main)"}
          required: ["repo_name", "file_path"]

    create_or_update_file:
      type: function
      function:
        name: "mini_github__create_or_update_file"
        description: "创建或更新仓库文件"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            file_path: {type: "string", description: "文件路径"}
            content: {type: "string", description: "文件内容"}
            commit_message: {type: "string", description: "提交信息"}
            branch: {type: "string", description: "分支名"}
          required: ["repo_name", "file_path", "content", "commit_message"]

    search_code:
      type: function
      function:
        name: "mini_github__search_code"
        description: "搜索代码"
        parameters:
          type: "object"
          properties:
            query: {type: "string", description: "代码关键词"}
            repo_name: {type: "string", description: "可选：限制在特定仓库内搜索"}
          required: ["query"]

    get_tree:
      type: function
      function:
        name: "mini_github__get_tree"
        description: "获取仓库文件树"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            branch: {type: "string", description: "分支名"}
            recursive: {type: "boolean", description: "是否递归"}
          required: ["repo_name"]

    create_issue:
      type: function
      function:
        name: "mini_github__create_issue"
        description: "创建一个新的 Issue"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            title: {type: "string", description: "Issue 标题"}
            body: {type: "string", description: "Issue 内容"}
            labels: {type: "list", description: "标签列表 (List[str])"}
          required: ["repo_name", "title", "body"]

    list_issues:
      type: function
      function:
        name: "mini_github__list_issues"
        description: "列出仓库的 Issue"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            state: {type: "string", description: "状态 (open/closed/all)"}
          required: ["repo_name"]

    get_issue:
      type: function
      function:
        name: "mini_github__get_issue"
        description: "获取特定 Issue 的详情"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            issue_number: {type: "integer", description: "Issue 编号"}
          required: ["repo_name", "issue_number"]

    update_issue:
      type: function
      function:
        name: "mini_github__update_issue"
        description: "更新 Issue 状态或内容"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            issue_number: {type: "integer", description: "Issue 编号"}
            state: {type: "string", description: "新状态 (open/closed)"}
            body: {type: "string", description: "新内容"}
          required: ["repo_name", "issue_number"]

    add_issue_comment:
      type: function
      function:
        name: "mini_github__add_issue_comment"
        description: "评论 Issue"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            issue_number: {type: "integer", description: "Issue 编号"}
            body: {type: "string", description: "评论内容"}
          required: ["repo_name", "issue_number", "body"]

    create_pull_request:
      type: function
      function:
        name: "mini_github__create_pull_request"
        description: "创建 Pull Request"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            title: {type: "string", description: "PR 标题"}
            body: {type: "string", description: "PR 内容"}
            head: {type: "string", description: "源分支"}
            base: {type: "string", description: "目标分支 (默认 main)"}
          required: ["repo_name", "title", "body", "head"]

    list_pull_requests:
      type: function
      function:
        name: "mini_github__list_pull_requests"
        description: "列出 PR"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            state: {type: "string", description: "状态"}
          required: ["repo_name"]

    get_pull_request:
      type: function
      function:
        name: "mini_github__get_pull_request"
        description: "获取 PR 详情"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            pr_number: {type: "integer", description: "PR 编号"}
          required: ["repo_name", "pr_number"]

    merge_pull_request:
      type: function
      function:
        name: "mini_github__merge_pull_request"
        description: "合并 PR"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            pr_number: {type: "integer", description: "PR 编号"}
            merge_method: {type: "string", description: "合并方式 (merge/squash/rebase)"}
          required: ["repo_name", "pr_number"]

    create_branch:
      type: function
      function:
        name: "mini_github__create_branch"
        description: "创建新分支"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            new_branch: {type: "string", description: "新分支名"}
            source_branch: {type: "string", description: "源分支名"}
          required: ["repo_name", "new_branch"]

    list_branches:
      type: function
      function:
        name: "mini_github__list_branches"
        description: "列出所有分支"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
          required: ["repo_name"]

    list_commits:
      type: function
      function:
        name: "mini_github__list_commits"
        description: "查看提交历史"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            branch: {type: "string", description: "分支名"}
            limit: {type: "integer", description: "数量限制"}
          required: ["repo_name"]

    get_commit:
      type: function
      function:
        name: "mini_github__get_commit"
        description: "查看提交详情"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
            sha: {type: "string", description: "提交 SHA"}
          required: ["repo_name", "sha"]

    fork_repository:
      type: function
      function:
        name: "mini_github__fork_repository"
        description: "Fork 仓库"
        parameters:
          type: "object"
          properties:
            repo_name: {type: "string", description: "仓库全名"}
          required: ["repo_name"]
    get_current_user:
      type: function
      function:
        name: "mini_github__get_current_user"
        description: "获取当前配置的 GitHub Token 所属的用户信息（我是谁？）"
        parameters:
          type: "object"
          properties: { }
          required: [ ]
    list_user_repos:
      type: function
      function:
        name: "mini_github__list_user_repos"
        description: "列出当前用户拥有或有权限操作的仓库列表"
        parameters:
          type: "object"
          properties:
            affiliation:
              type: "string"
              description: "筛选关系: 'owner' (拥有的), 'collaborator' (协作的), 'organization_member' (组织的). 默认 'owner,collaborator'"
            limit:
              type: "integer"
              description: "返回数量限制 (默认 30)"
          required: [ ]